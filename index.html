<script>
const GRANTER = 0.0072; // wiki granter

function calcXp(){
  const cur   = Math.max(50, Math.min(100, +document.getElementById('curStr').value));
  const tar   = Math.max(51, Math.min(100, +document.getElementById('tarStr').value));
  const bonus = +document.getElementById('bonusAmt').value || 86;
  const chancePerMin = +document.getElementById('chanceMin').value || 15;
  const has   = document.getElementById('hasXpBoost').checked;
  if(cur >= tar){ alert('Target must be > Current'); return; }

  const triggerChance = has ? chancePerMin / 60 / 100 : 0;
  const bonusPerSec   = triggerChance * bonus;
  const avgXPperSec   = 1 + bonusPerSec;
  const secondsNeeded = (tar - cur) / avgXPperSec;

  const totalMin = secondsNeeded / 60;
  const h = Math.floor(totalMin / 60);
  const m = Math.ceil(totalMin % 60 || 1);

  document.getElementById('xpOut').innerHTML =
    `Average XP/s: <b>${avgXPperSec.toFixed(2)}</b><br>` +
    `Est. time to target: <b>${h}h ${m}m</b>`;
}

function calcGranter(){
  const str = Math.max(50, Math.min(100, +document.getElementById('granterStr').value));
  const perSec = GRANTER * str / 60 / 100;
  const avg    = 1 / perSec;
  const wait95 = -Math.log(1-0.95) / perSec;

  const totalMin = avg / 60;
  const h1 = Math.floor(totalMin / 60);
  const m1 = Math.ceil(totalMin % 60 || 1);
  const totalMin95 = wait95 / 60;
  const h95 = Math.floor(totalMin95 / 60);
  const m95 = Math.ceil(totalMin95 % 60 || 1);

  document.getElementById('granterOut').innerHTML =
    `Average: <b>${h1 ? h1+'h '+m1+'m' : m1+'m'}</b><br>` +
    `95 % within: <b>${h95 ? h95+'h '+m95+'m' : m95+'m'}</b>`;
}
</script>

<!-- insert this line inside the XP card -->
<label>Custom chance / min (%) <input id="chanceMin" type="number" min="0" max="100" step="0.1" value="15"></label>
